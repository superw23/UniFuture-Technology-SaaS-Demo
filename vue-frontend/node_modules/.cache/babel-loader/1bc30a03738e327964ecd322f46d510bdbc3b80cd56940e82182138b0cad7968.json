{"ast":null,"code":"import SaleService from '@/services/Sale/SaleService';\nimport jsPDF from 'jspdf';\nimport autoTable from 'jspdf-autotable';\nimport * as XLSX from 'xlsx';\nfunction s2ab(s) {\n  // Convert a string to an ArrayBuffer\n  const buf = new ArrayBuffer(s.length);\n  const view = new Uint8Array(buf);\n  for (let i = 0; i < s.length; i++) {\n    view[i] = s.charCodeAt(i) & 0xFF;\n  }\n  return buf;\n}\nexport default {\n  name: 'Sales',\n  data() {\n    return {\n      itemsPerPage: 5,\n      //the number of customer shown in one page\n      pageNum: 0,\n      //store current page number\n      sales: [],\n      //store sales per page \n      fixedSales: [],\n      //store all sales\n      search: '',\n      //store search content\n      startDate: '',\n      endDate: '',\n      isSuccess: false,\n      editing: false,\n      isEdited: false,\n      pdfIconSize: '2em',\n      excelIconSize: '2em'\n    };\n  },\n  methods: {\n    //Get all returned sales records\n    async getReturnSales() {\n      await SaleService.getReturnSales().then(response => {\n        this.sales = response.data;\n        this.fixedSales = response.data;\n      });\n    },\n    //Get returned sales records within given dates\n    getSalesWithinGivenDates() {\n      SaleService.getReturnSalesWithinGivenDates(this.startDate, this.endDate).then(response => {\n        this.sales = response.data;\n      });\n    },\n    //Sort returned sales records of a given field\n    sort(field) {\n      SaleService.sortReturnSales(this.pageNum, this.itemsPerPage, field).then(response => {\n        this.sales = response.data;\n      });\n    },\n    //Set the number of records shown in one page\n    pagination(pageNum) {\n      this.pageNum = pageNum;\n      if (this.pageNum == -1) {\n        this.pageNum = 0;\n        return;\n      }\n      SaleService.returnPagination(pageNum, this.itemsPerPage).then(response => {\n        this.sales = response.data;\n      });\n    },\n    //Set the number of records shown in one page\n    changeItemPerPage(num) {\n      this.itemsPerPage = num;\n      this.pagination(this.pageNum, this.itemsPerPage);\n    },\n    //Download the returned sales table in pdf format\n    downloadPDF() {\n      const columns = [{\n        header: 'Order No.',\n        dataKey: 'id'\n      }, {\n        header: 'Customer Name',\n        dataKey: 'customerName'\n      }, {\n        header: 'Product ID',\n        dataKey: 'productId'\n      }, {\n        header: 'Name',\n        dataKey: 'name'\n      }, {\n        header: 'Quantity',\n        dataKey: 'num'\n      }, {\n        header: 'Return Price',\n        dataKey: 'returnPrice'\n      }, {\n        header: 'Total',\n        dataKey: 'total'\n      }];\n      const pdf = new jsPDF();\n      //text is placed using x, y coordinates\n      pdf.setFontSize(20).text(\"Returned Sales\", 80, 10);\n      //use autoTable plugin\n      autoTable(pdf, {\n        columns,\n        body: this.sales,\n        margin: {\n          top: 30\n        }\n      });\n      //show total stock\n      pdf.setFontSize(16).text('Total returned quantity: ' + this.total, 80, 20);\n      //download pdf\n      pdf.save(\"ReturnedSales.pdf\");\n    },\n    //Download the returned sales table in excel format\n    downloadExcel() {\n      const filteredReturnSales = this.filteredSales.map(sales => {\n        return {\n          OrderNo: sales.id,\n          Name: sales.name,\n          ProductID: sales.productId,\n          Quantity: sales.num,\n          ReturnPrice: sales.returnPrice,\n          Total: sales.total,\n          Customer: sales.customerName,\n          Date: sales.date\n        };\n      });\n\n      // Create a new workbook\n      const wb = XLSX.utils.book_new();\n\n      // Add a new worksheet to the workbook\n      const ws = XLSX.utils.json_to_sheet(filteredReturnSales);\n\n      // Add the worksheet to the workbook\n      XLSX.utils.book_append_sheet(wb, ws, 'Sales');\n\n      // Write the workbook to a binary string\n      const wbout = XLSX.write(wb, {\n        bookType: 'xlsx',\n        type: 'binary'\n      });\n\n      // Convert the binary string to a Blob object\n      const blob = new Blob([s2ab(wbout)], {\n        type: 'application/octet-stream'\n      });\n\n      // Create a temporary link to the file and trigger a download\n      const url = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = 'Returned Sales.xlsx';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    }\n  },\n  async created() {\n    await this.getReturnSales();\n    this.itemsPerPage = this.sales.length;\n  },\n  computed: {\n    //Filter returned sales records accoring to the product name\n    filteredSales() {\n      return this.sales.filter(sale => sale.name.toLowerCase().includes(this.search.toLowerCase()));\n    },\n    //Calculate total number of returned sales records\n    total() {\n      return this.sales.reduce((total, curr) => total = total + curr.returnNum, 0);\n    },\n    //Calculate total pages of returned sales records\n    totalPages() {\n      return Math.ceil(this.fixedSales.length / this.itemsPerPage);\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["SaleService","jsPDF","autoTable","XLSX","s2ab","s","buf","ArrayBuffer","length","view","Uint8Array","i","charCodeAt","name","data","itemsPerPage","pageNum","sales","fixedSales","search","startDate","endDate","isSuccess","editing","isEdited","pdfIconSize","excelIconSize","methods","getReturnSales","then","response","getSalesWithinGivenDates","getReturnSalesWithinGivenDates","sort","field","sortReturnSales","pagination","returnPagination","changeItemPerPage","num","downloadPDF","columns","header","dataKey","pdf","setFontSize","text","body","margin","top","total","save","downloadExcel","filteredReturnSales","filteredSales","map","OrderNo","id","Name","ProductID","productId","Quantity","ReturnPrice","returnPrice","Total","Customer","customerName","Date","date","wb","utils","book_new","ws","json_to_sheet","book_append_sheet","wbout","write","bookType","type","blob","Blob","url","window","URL","createObjectURL","link","document","createElement","href","download","appendChild","click","removeChild","created","computed","filter","sale","toLowerCase","includes","reduce","curr","returnNum","totalPages","Math","ceil"],"sourceRoot":"","sources":["C:\\Users\\Ella\\Desktop\\vue-frontend\\src\\components\\Sales\\Sale\\ReturnSale.vue"],"sourcesContent":["// Made by GRPTeam202205\r\n<template>\r\n    <!--Search bar-->\r\n    <nav class=\"navbar\">\r\n        <div class=\"container-fluid\">\r\n            <!--Drop-down menu to choose the number of Records Per Page-->\r\n            <div class=\"dropdown\">\r\n                <button class=\"btn dropdown-toggle\" type=\"button\" id=\"dropdownMenu2\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\r\n                    {{$t('Records Per Page')}}\r\n                </button>\r\n                <ul class=\"dropdown-menu\" aria-labelledby=\"dropdownMenu2\">\r\n                    <li><button class=\"dropdown-item\" type=\"button\" @click=\"changeItemPerPage(5)\">5</button></li>\r\n                    <li><button class=\"dropdown-item\" type=\"button\" @click=\"changeItemPerPage(10)\">10</button></li>\r\n                    <li><button class=\"dropdown-item\" type=\"button\" @click=\"changeItemPerPage(15)\">15</button></li>\r\n                </ul>\r\n            </div>\r\n            <a class=\"navbar-brand\"></a>\r\n            <form class=\"d-flex\" role=\"search\">\r\n            <input class=\"form-control me-2\" type=\"search\" :placeholder=\"$t('Search')\" aria-label=\"Search\" v-model=\"search\">\r\n            <button class=\"btn btn-outline-success\" type=\"submit\">{{$t('Search')}}</button>\r\n            </form>\r\n        </div>\r\n    </nav>\r\n\r\n    <!--Sale List-->\r\n    <div class=\"container\">\r\n        <h1 class=\"test-center\">{{$t('Sale.Returned Sales')}}</h1>\r\n        <br>\r\n        <div class=\"alert alert-success\" v-if=\"isSuccess\">\r\n            {{$t('Sale.The sale is returned successfully! Refresh the page to see the result.')}}\r\n        </div>\r\n        <div class=\"row align-items-center\">\r\n            <div class=\"col\"></div>\r\n            <div class=\"col-2\">\r\n                {{$t('Start Date:')}} <input  type=\"date\" class=\"form-control me-2\" :placeholder=\"$t('Choose a start date')\" id= \"date\" v-model=\"startDate\">\r\n            </div>\r\n            <div class=\"col-2\">\r\n                {{$t('End Date:')}} <input type=\"date\" class=\"form-control\" :placeholder=\"$t('Choose an end date')\" id= \"date\" v-model=\"endDate\">\r\n            </div>\r\n            <div class=\"col-auto\">\r\n            <img src=\"/static/Others/check.png\" width=\"20\" height=\"20\" type=\"submit\" @click=\"getSalesWithinGivenDates\"/>\r\n            </div>\r\n            <div class=\"col\"></div>\r\n        </div>\r\n        <br>\r\n        <div class=\"table-responsive\">\r\n            <table class=\"table table-stripped\">\r\n                <thead>\r\n                    <th>\r\n                        <i class=\"fa fa-sort-numeric-asc\" type=\"button\" aria-hidden=\"true\" @click=\"sort('id')\"/>\r\n                        {{$t('Order No.')}}\r\n                    </th>\r\n                    <th>\r\n                        <i class=\"fa fa-sort-alpha-asc\" type=\"button\" aria-hidden=\"true\" @click=\"sort('name')\"/>\r\n                        {{$t('Name')}}\r\n                    </th>\r\n                    <th>\r\n                        <i class=\"fa fa-sort-alpha-asc\" type=\"button\" aria-hidden=\"true\" @click=\"sort('num')\"/>\r\n                        {{$t('Quantity')}}\r\n                    </th>\r\n                    <th>\r\n                        <i class=\"fa fa-sort-alpha-asc\" type=\"button\" aria-hidden=\"true\" @click=\"sort('returnPrice')\"/>\r\n                        {{$t('Return Price')}}\r\n                    </th>\r\n                    <th>\r\n                        <i class=\"fa fa-sort-alpha-asc\" type=\"button\" aria-hidden=\"true\" @click=\"sort('total')\"/>\r\n                        {{$t('Total')}}\r\n                    </th>\r\n                    <th>\r\n                        <i class=\"fa fa-sort-alpha-asc\" type=\"button\" aria-hidden=\"true\" @click=\"sort('productId')\"/>\r\n                        {{$t('Product ID')}}\r\n                    </th>\r\n                    <th>\r\n                        <i class=\"fa fa-sort-alpha-asc\" type=\"button\" aria-hidden=\"true\" @click=\"sort('customerName')\"/>\r\n                        {{$t('Customer Name')}}\r\n                    </th>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for = \"sale in filteredSales\" v-bind:key = \"sale.id\" class=\"table-bordered\">\r\n                        <td>{{sale.id}}</td>\r\n                        <td>{{sale.name}}</td>\r\n                        <td>{{sale.returnNum}}</td>\r\n                        <td>{{sale.returnPrice}}</td>\r\n                        <td>{{sale.returnTotal}}</td>\r\n                        <td>{{sale.productId}}</td>\r\n                        <td>{{sale.customerName}}</td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <h5>{{$t('Sale.Total return sales')}}: {{total}}</h5>\r\n        <img src=\"/static/Others/pdf.png\" width=\"38\" height=\"35\" type=\"button\" @click=\"downloadPDF\"/>\r\n        &nbsp\r\n        <img src=\"/static/Others/xlsx.png\" width=\"35\" height=\"35\" type=\"button\" @click=\"downloadExcel\"/>\r\n    </div>\r\n    \r\n    <!--Page navigation bar-->\r\n    <nav class=\"navbar\">\r\n        <div class=\"container-fluid\">\r\n            <h5>Total Pages: {{this.totalPages}}</h5>\r\n            <a class=\"navbar-brand\"></a>\r\n            <nav aria-label=\"Page navigation example\">\r\n                <ul class=\"pagination\">\r\n                    <li class=\"page-item\"><a class=\"page-link\" href=\"#\" @click=\"pagination(this.pageNum - 1)\">{{$t('Previous')}}</a></li>\r\n                    <li class=\"page-item\"><a class=\"page-link\" href=\"#\" @click=\"pagination(0)\">{{this.pageNum+1}}</a></li>\r\n                    <li class=\"page-item\"><a class=\"page-link\" href=\"#\" @click=\"pagination(pageNum+1)\">{{$t('Next')}}</a></li>\r\n                </ul>\r\n            </nav>\r\n        </div>\r\n    </nav>\r\n</template>\r\n\r\n<script>\r\nimport SaleService from '@/services/Sale/SaleService';\r\nimport jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\nimport * as XLSX from 'xlsx'\r\n\r\nfunction s2ab(s) {\r\n  // Convert a string to an ArrayBuffer\r\n  const buf = new ArrayBuffer(s.length);\r\n  const view = new Uint8Array(buf);\r\n  for (let i = 0; i < s.length; i++) {\r\n    view[i] = s.charCodeAt(i) & 0xFF;\r\n  }\r\n  return buf;\r\n}\r\nexport default {\r\n    name: 'Sales',\r\n    data(){\r\n        return{\r\n            itemsPerPage: 5,//the number of customer shown in one page\r\n            pageNum: 0,//store current page number\r\n            sales: [],//store sales per page \r\n            fixedSales: [],//store all sales\r\n            search:'',//store search content\r\n            startDate: '',\r\n            endDate: '',\r\n            isSuccess: false,\r\n            editing: false,\r\n            isEdited: false,\r\n            pdfIconSize: '2em',\r\n            excelIconSize: '2em',\r\n        }\r\n    },\r\n    methods:{\r\n        //Get all returned sales records\r\n        async getReturnSales(){\r\n            await SaleService.getReturnSales().then((response)=>{\r\n                this.sales = response.data;\r\n                this.fixedSales = response.data;\r\n            });\r\n        },\r\n        //Get returned sales records within given dates\r\n        getSalesWithinGivenDates(){\r\n            SaleService.getReturnSalesWithinGivenDates(this.startDate,this.endDate).then((response)=>{\r\n                this.sales = response.data;\r\n            });\r\n        },\r\n        //Sort returned sales records of a given field\r\n        sort(field){\r\n            SaleService.sortReturnSales(this.pageNum, this.itemsPerPage, field).then((response)=>{\r\n                this.sales = response.data;\r\n            });\r\n        },\r\n        //Set the number of records shown in one page\r\n        pagination(pageNum){\r\n            this.pageNum = pageNum;\r\n            if(this.pageNum==-1) {\r\n                this.pageNum=0;\r\n                return;\r\n            }\r\n            SaleService.returnPagination(pageNum,this.itemsPerPage).then((response)=>{\r\n                this.sales = response.data;\r\n            });\r\n        },\r\n        //Set the number of records shown in one page\r\n        changeItemPerPage(num){\r\n            this.itemsPerPage = num;\r\n            this.pagination(this.pageNum,this.itemsPerPage);\r\n        },\r\n        //Download the returned sales table in pdf format\r\n        downloadPDF(){\r\n            const columns = [\r\n                    { header: 'Order No.', dataKey: 'id' },\r\n                    { header: 'Customer Name', dataKey: 'customerName' },\r\n                    { header: 'Product ID', dataKey: 'productId' },\r\n                    { header: 'Name', dataKey: 'name' },\r\n                    { header: 'Quantity', dataKey: 'num' },\r\n                    { header: 'Return Price', dataKey: 'returnPrice' },\r\n                    { header: 'Total', dataKey: 'total' }\r\n                ];\r\n            const pdf = new jsPDF();\r\n            //text is placed using x, y coordinates\r\n            pdf.setFontSize(20).text(\"Returned Sales\", 80, 10);\r\n            //use autoTable plugin\r\n            autoTable(pdf, {\r\n                columns,\r\n                body: this.sales,\r\n                margin:{top: 30}\r\n            });\r\n            //show total stock\r\n            pdf.setFontSize(16).text('Total returned quantity: ' + this.total, 80, 20);\r\n            //download pdf\r\n            pdf.save(\"ReturnedSales.pdf\");\r\n        },\r\n        //Download the returned sales table in excel format\r\n        downloadExcel() {\r\n            const filteredReturnSales = this.filteredSales.map(sales => {\r\n                return {\r\n                    OrderNo: sales.id,\r\n                    Name: sales.name,\r\n                    ProductID: sales.productId,\r\n                    Quantity: sales.num,\r\n                    ReturnPrice: sales.returnPrice,\r\n                    Total: sales.total,\r\n                    Customer: sales.customerName,\r\n                    Date: sales.date,\r\n                };\r\n            });\r\n\r\n            // Create a new workbook\r\n            const wb = XLSX.utils.book_new();\r\n\r\n            // Add a new worksheet to the workbook\r\n            const ws = XLSX.utils.json_to_sheet(filteredReturnSales);\r\n\r\n            // Add the worksheet to the workbook\r\n            XLSX.utils.book_append_sheet(wb, ws, 'Sales');\r\n\r\n            // Write the workbook to a binary string\r\n            const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'binary' });\r\n\r\n            // Convert the binary string to a Blob object\r\n            const blob = new Blob([s2ab(wbout)], { type: 'application/octet-stream' });\r\n\r\n            // Create a temporary link to the file and trigger a download\r\n            const url = window.URL.createObjectURL(blob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.download = 'Returned Sales.xlsx';\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            document.body.removeChild(link);\r\n        }\r\n    },\r\n    async created(){\r\n        await this.getReturnSales()\r\n        this.itemsPerPage = this.sales.length\r\n    },\r\n    computed:{\r\n        //Filter returned sales records accoring to the product name\r\n        filteredSales(){\r\n            return this.sales.filter(sale => sale.name.toLowerCase().includes(this.search.toLowerCase()));\r\n        },\r\n        //Calculate total number of returned sales records\r\n        total(){\r\n            return this.sales.reduce((total,curr)=>(total=total+curr.returnNum),0);\r\n        },\r\n        //Calculate total pages of returned sales records\r\n        totalPages(){\r\n            return (Math.ceil(this.fixedSales.length / this.itemsPerPage))\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}