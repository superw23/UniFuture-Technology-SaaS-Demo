{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container py-5\"\n};\nconst _hoisted_2 = {\n  class: \"row\"\n};\nconst _hoisted_3 = {\n  class: \"col-md-6 col-lg-5 col-xl-4 mb-4 mb-md-0\"\n};\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"h5\", {\n  class: \"font-weight-bold mb-3 text-center text-lg-start\"\n}, \"Members\", -1 /* HOISTED */);\nconst _hoisted_5 = {\n  class: \"card\"\n};\nconst _hoisted_6 = {\n  class: \"container\"\n};\nconst _hoisted_7 = [\"innerHTML\"];\nconst _hoisted_8 = {\n  class: \"col-md-6 col-lg-7 col-xl-8\",\n  style: {\n    \"height\": \"700px\",\n    \"overflow\": \"auto\"\n  }\n};\nconst _hoisted_9 = [\"innerHTML\"];\nconst _hoisted_10 = {\n  class: \"bg-white mb-3\"\n};\nconst _hoisted_11 = {\n  class: \"form-outline\"\n};\nconst _hoisted_12 = {\n  class: \"form-label\",\n  for: \"textAreaExample2\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createCommentVNode(\" Group chatting page \"), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createCommentVNode(\" Show online members \"), _hoisted_4, _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", {\n    class: \"card-body\",\n    innerHTML: $data.member\n  }, null, 8 /* PROPS */, _hoisted_7)])])]), _createCommentVNode(\" Show chatting messages \"), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"ul\", {\n    class: \"d-flex flex-column\",\n    innerHTML: $data.content\n  }, null, 8 /* PROPS */, _hoisted_9), _createElementVNode(\"li\", _hoisted_10, [_createElementVNode(\"div\", _hoisted_11, [_withDirectives(_createElementVNode(\"textarea\", {\n    class: \"form-control\",\n    id: \"textAreaExample2\",\n    rows: \"4\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => this.message = $event)\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, this.message]]), _createElementVNode(\"label\", _hoisted_12, _toDisplayString(_ctx.$t('Message')), 1 /* TEXT */)])]), _createElementVNode(\"button\", {\n    type: \"button\",\n    class: \"btn btn-info btn-rounded float-end\",\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.websocketsend && $options.websocketsend(...args))\n  }, _toDisplayString(_ctx.$t('Send')), 1 /* TEXT */)])])])], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */);\n}","map":{"version":3,"mappings":";;EAGSA,KAAK,EAAC;AAAgB;;EAClBA,KAAK,EAAC;AAAK;;EACPA,KAAK,EAAC;AAAyC;gCAEhDC,oBAAwE;EAApED,KAAK,EAAC;AAAiD,GAAC,SAAO;;EAC9DA,KAAK,EAAC;AAAM;;EACRA,KAAK,EAAC;AAAW;;;EAOzBA,KAAK,EAAC,4BAA4B;EAACE,KAAoC,EAApC;IAAA;IAAA;EAAA;;;;EAGhCF,KAAK,EAAC;AAAe;;EAChBA,KAAK,EAAC;AAAc;;EAEdA,KAAK,EAAC,YAAY;EAACG,GAAG,EAAC;;;6DApBlDC,4CAA4B,EAC5BH,oBAyBM,OAzBNI,UAyBM,GAxBFJ,oBAuBM,OAvBNK,UAuBM,GAtBFL,oBASM,OATNM,UASM,GARFH,4CAA4B,EAC5BI,UAAwE,EACxEP,oBAKM,OALNQ,UAKM,GAJFR,oBAGM,OAHNS,UAGM,GAFNT,oBACM;IADDD,KAAK,EAAC,WAAW;IAACW,SAAe,EAAPC;6CAKvCR,+CAA+B,EAC/BH,oBAUM,OAVNY,UAUM,GATFZ,oBACK;IADDD,KAAK,EAAC,oBAAoB;IAACW,SAAgB,EAARC;uCAEvCX,oBAKK,MALLa,WAKK,GAJDb,oBAGM,OAHNc,WAGM,mBAFFd,oBAAgG;IAAtFD,KAAK,EAAC,cAAc;IAACgB,EAAE,EAAC,kBAAkB;IAACC,IAAI,EAAC,GAAG;oEAAeC,OAAO;sDAAPA,OAAO,KACnFjB,oBAA0E,SAA1EkB,WAA0E,mBAAvBC,OAAE,iCAG7DnB,oBAA+G;IAAvGoB,IAAI,EAAC,QAAQ;IAACrB,KAAK,EAAC,oCAAoC;IAAEsB,OAAK,yCAAEC,yDAAa;sBAAIH,OAAE","names":["class","_createElementVNode","style","for","_createCommentVNode","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","innerHTML","$data","_hoisted_8","_hoisted_10","_hoisted_11","id","rows","message","_hoisted_12","_ctx","type","onClick","$options"],"sourceRoot":"","sources":["C:\\Users\\SuperW\\Desktop\\暑期实习\\vue-frontend\\src\\components\\Others\\Settings\\Communication.vue"],"sourcesContent":["//Adapted By GRPTeam202205 (MIT license)\r\n<template>\r\n    <!-- Group chatting page -->\r\n    <div class=\"container py-5\">\r\n        <div class=\"row\">\r\n            <div class=\"col-md-6 col-lg-5 col-xl-4 mb-4 mb-md-0\">\r\n                <!-- Show online members -->\r\n                <h5 class=\"font-weight-bold mb-3 text-center text-lg-start\">Members</h5>\r\n                <div class=\"card\">\r\n                    <div class=\"container\">\r\n                    <div class=\"card-body\" v-html=\"member\">\r\n                    </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <!-- Show chatting messages -->\r\n            <div class=\"col-md-6 col-lg-7 col-xl-8\" style=\" height:700px; overflow:auto\">\r\n                <ul class=\"d-flex flex-column\" v-html=\"content\">\r\n                </ul>\r\n                <li class=\"bg-white mb-3\">\r\n                    <div class=\"form-outline\">\r\n                        <textarea class=\"form-control\" id=\"textAreaExample2\" rows=\"4\" v-model=\"this.message\"></textarea>\r\n                        <label class=\"form-label\" for=\"textAreaExample2\">{{$t('Message')}}</label>\r\n                    </div>\r\n                </li>\r\n                <button type=\"button\" class=\"btn btn-info btn-rounded float-end\" @click=\"websocketsend\">{{$t('Send')}}</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data() {\r\n        return {\r\n            userName: '',\r\n            message: '',\r\n            content: '',\r\n            member: '',\r\n            users: [],\r\n            messages: []\r\n        };\r\n    },\r\n    created(){\r\n        this.userName = sessionStorage.getItem('username')\r\n    },\r\n    mounted() {\r\n        this.initWebSocket()\r\n    },\r\n    methods: {\r\n        initWebSocket(){\r\n            const wsuri = 'ws://120.55.194.201:8085/websocket/'+this.userName     \r\n            this.websock = new WebSocket(wsuri)\r\n            this.websock.onmessage = this.websocketonmessage\r\n            this.websock.onopen = this.websocketonopen\r\n            this.websock.onerror = this.websocketonerror\r\n            this.websock.onclose = this.websocketclose\r\n        },\r\n        //Send messages\r\n        websocketsend(){\r\n            let message = {from: this.userName, to: \"Tom\", text: this.message}\r\n            this.websock.send(JSON.stringify(message))\r\n            this.messages.push({user: this.userName, text: this.message})\r\n            this.addNewContent(null, 'You', this.message)\r\n            this.message = ''\r\n        },\r\n        websocketonopen(){\r\n            console.log(\"Open WebSocket successfully\")\r\n        },\r\n        //Reconnect the websocket if it is not opened successfully\r\n        websocketonerror(){\r\n            this.initWebSocket()\r\n        },\r\n        //Receive messages\r\n        websocketonmessage(msg){\r\n            console.log(msg.data)\r\n            let data = JSON.parse(msg.data)\r\n            if(data.users){//online users\r\n                for(var key in data.users){\r\n                    if(this.users==''){\r\n                        this.addNewMember(data.users[key]['username'])\r\n                    }\r\n                        \r\n                    for(var user in this.users){\r\n                        console.log(this.users[user]['username'])\r\n                        if(data.users[key]['username']!=this.users[user]['username'])\r\n                            this.addNewMember(data.users[key]['username'])\r\n                    }\r\n                }\r\n                this.users = data.users\r\n            }\r\n            else{\r\n                if(data.from!=this.userName)\r\n                    this.addNewContent(data.from, null, data.text)\r\n            }\r\n        },\r\n        //Close the websocket\r\n        websocketclose(){\r\n            this.websock.close()\r\n        },\r\n        //Add chatting content of team members to the chat box\r\n        addNewContent(remoteSender, sender, text){\r\n            let html\r\n            if(sender){\r\n                html =  \r\n                    \"<div class=\\\"card\\\">\\n\"+\r\n                    \"<div class=\\\"card-header d-flex justify-content-between p-3\\\">\\n\"+\r\n                     \"   <p class=\\\"fw-bold mb-0\\\">\"+sender+\"</p>\\n\"+\r\n                      \"  <p class=\\\"text-muted small mb-0\\\"><i class=\\\"far fa-clock\\\"></i> 12 mins ago</p>\\n\"+\r\n                    \"</div>\\n\"+\r\n                    \"<div class=\\\"card-body\\\">\\n\"+\r\n                     \"   <p class=\\\"mb-0\\\">\"+text+\"</p>\\n\"+\r\n                    \"</div>\\n\"+\r\n                    \"</div>\"\r\n            }else if(remoteSender){\r\n                    html = \r\n                            \"<div class=\\\"card w-100\\\">\\n\"+\r\n                            \"<div class=\\\"card-header d-flex justify-content-between p-3\\\">\\n\"+\r\n                                \"<p class=\\\"fw-bold mb-0\\\">\"+remoteSender+\"</p>\\n\"+\r\n                                \"<p class=\\\"text-muted small mb-0\\\"><i class=\\\"far fa-clock\\\"></i> 13 mins ago</p>\\n\"+\r\n                            \"</div>\\n\"+\r\n                            \"<div class=\\\"card-body\\\">\\n\"+\r\n                            \"    <p class=\\\"mb-0\\\">\\n\"+ text + \"</p>\\n\"+\r\n                            \"</div>\\n\"+\r\n                        \"</div>\\n\"\r\n            }\r\n            this.content+=html\r\n        },\r\n        //Add new team members to the chatting list\r\n        addNewMember(name){\r\n            let memberHTML\r\n            memberHTML = \r\n                    \"<li class=\\\"p-2 border-bottom\\\" style=\\\"background-color: #eee;\\\">\\n\"+\r\n                        \"<a class=\\\"d-flex justify-content-between\\\">\\n\"+\r\n                            \"<div class=\\\"d-flex flex-row\\\">\\n\"+\r\n                                \"<img src=\\\"/static/UserProfile/user.png\\\" alt=\\\"avatar\\\" class=\\\"rounded-circle d-flex align-self-start me-3 shadow-1-strong\\\" width=\\\"60\\\">\\n\"+\r\n                                \"<div class=\\\"pt-1\\\">\\n\"+\r\n                                    \"<p class=\\\"fw-bold mb-0\\\">\"+name+\"</p>\\n\"+\r\n                                    \"<p class=\\\"small text-muted\\\">Active Mode</p>\\n\"+\r\n                                \"</div>\\n\"+\r\n                            \"</div>\\n\"+\r\n                            \"<div class=\\\"pt-1\\\">\\n\"+\r\n                                \"<p class=\\\"small text-muted mb-1\\\">Just now</p>\\n\"+\r\n                            \"</div>\\n\"+\r\n                        \"</a>\\n\"+\r\n                    \"</li>\\n\"\r\n            this.member+=memberHTML\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}